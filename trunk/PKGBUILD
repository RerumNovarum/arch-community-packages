# $Id$
# Maintainer: Sergej Pupykin <pupykin.s+arch@gmail.com>
# Contributor: Sergej Pupykin <pupykin.s+arch@gmail.com>

pkgname=tvision
pkgver=2.0.3
pkgrel=2
pkgdesc="turbo vision library port (console interface)"
arch=(i686 x86_64)
url="http://tvision.sourceforge.net"
license=("GPL")
depends=(gpm gcc-libs libxmu)
makedepends=(gcc34)
options=('!makeflags')
source=("http://prdownloads.sourceforge.net/tvision/rhtvision-$pkgver.src.tar.gz")
md5sums=('b6129f5c510ba9d28d21c9575b7e1c75')

build () {
  cd $startdir/src/$pkgname
  unset CFLAGS CXXFLAGS CPPFLAGS
  [ "$CARCH" = "x86_64" ] && export CFLAGS="-march=x86-64 -O2 -pipe"
  [ "$CARCH" = "x86_64" ] && export CXXFLAGS="-march=x86-64 -O2 -pipe"
  ./configure --prefix=/usr --include=/usr/include
  sed -i "s|#include <asm/io.h>|#include <sys/io.h>|" classes/linux/linuxdis.cc
  sed -i "s|#include <asm/io.h>|#include <sys/io.h>|" classes/linux/linuxscr.cc
  make RHIDE_GCC=gcc-3.4 RHIDE_GXX=g++-3.4 || return 1
  make prefix=$startdir/pkg/usr install
}
