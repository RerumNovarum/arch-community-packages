# Maintainer: Daniel Micay <danielmicay@gmail.com>
pkgname=hardening-wrapper
pkgver=1
pkgrel=1
pkgdesc='Wrapper script for building hardened executables by default'
arch=(any)
url='https://archlinux.org/'
license=('GPL')
depends=(bash)
source=(cc-wrapper.sh path.sh)
sha1sums=('99d2a33b30790c51e7ea4340dc85368ae65cbdd1'
          '1e5f6d9931f01b26bb4b6fbb839e21d34d534cdc')

package() {
  mkdir -p "$pkgdir/usr/lib/hardening-wrapper/bin"
  install -m644 path.sh "$pkgdir/usr/lib/hardening-wrapper/path.sh"
  install -m755 cc-wrapper.sh "$pkgdir/usr/lib/hardening-wrapper"
  ln -s ../cc-wrapper.sh "$pkgdir/usr/lib/hardening-wrapper/bin/c89"
  ln -s ../cc-wrapper.sh "$pkgdir/usr/lib/hardening-wrapper/bin/c99"
  ln -s ../cc-wrapper.sh "$pkgdir/usr/lib/hardening-wrapper/bin/cc"
  ln -s ../cc-wrapper.sh "$pkgdir/usr/lib/hardening-wrapper/bin/c++"
  ln -s ../cc-wrapper.sh "$pkgdir/usr/lib/hardening-wrapper/bin/clang"
  ln -s ../cc-wrapper.sh "$pkgdir/usr/lib/hardening-wrapper/bin/clang++"
  ln -s ../cc-wrapper.sh "$pkgdir/usr/lib/hardening-wrapper/bin/gcc"
  ln -s ../cc-wrapper.sh "$pkgdir/usr/lib/hardening-wrapper/bin/g++"
}
