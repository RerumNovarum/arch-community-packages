# Initial contributor: flixie <69one@gmx.net>
# Contributor: Lukas Jirkovsky <l.jirkovsky@gmail.com>
# Mantainer: Imanol Celaya <ornitorrincos@archlinux-es.org>
pkgname=luxrender
pkgver=0.6.1
_pkgver=36533b0843bd
_luxblend=4b8109987265
pkgrel=1.1
pkgdesc="Rendering system for physically correct, unbiased image synthesis"
arch=('i686' 'x86_64')
url="http://www.luxrender.net/"
license=('GPL')
depends=('openexr' 'libgl' 'boost')
optdepends=('wxgtk')
makedepends=('cmake')
install='lux.install'
source=(http://src.luxrender.net/lux/archive/${_pkgver}.tar.bz2
        http://src.luxrender.net/luxblend/archive/${_luxblend}.tar.bz2)
md5sums=('1c2702bbce97dd7dc95adbd16b0bbed7'
         '090e2255428fe7ee2cad132ba67de23a')

build() {
  cd "$srcdir"/lux-${_pkgver}
  cmake -DCMAKE_INSTALL_PREFIX=/usr .
  make || return 1
  make DESTDIR=$pkgdir install
  
  # copy files because you can't specify the path on cmake in x86-64
  if [ "${CARCH}" == "x86_64" ]; then
    mkdir $pkgdir/usr/lib
    cp $pkgdir/usr/lib64/* $pkgdir/usr/lib/
    rm -rf $pkgdir/usr/lib64
  fi

  # install blender exporter
  install -d -m755 $pkgdir/usr/share/blender/scripts
  install -m644 $srcdir/luxblend-${_luxblend}/*.py $pkgdir/usr/share/blender/scripts
}

# vim:set ts=2 sw=2 et:
