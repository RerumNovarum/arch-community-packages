# $Id$
# Maintainer: Sergej Pupykin <pupykin.s+arch@gmail.com>
# Contributor: Tiago Pierezan Camargo <tcamargo@gmail.com>
# Contributor: robb_force <robb_force@holybuffalo.net>

pkgname=nestopia
pkgver=1.41
pkgrel=1
pkgdesc='An NES emulator featuring cycle exact emulation, a ridiculous number of mappers, and lots of custom sound chips.'
url='http://0ldsk00l.ca/nestopia.html'
license=('GPL')
arch=('i686' 'x86_64')
depends=('sdl' 'alsa-lib' 'gtk3' 'mesa')
makedepends=('unzip')
source=("$pkgname-$pkgver.tar.gz::https://github.com/rdanbrook/nestopia/tarball/$pkgver"
	"nestopia_bogus_error_on_save_settings.patch")
md5sums=('6baa5cb1bd4e929b200bdf33ea221606'
         '0160078c9afcbb1a6ac389c3989929f7')

build() {
  cd ${srcdir}/rdanbrook-nestopia-*
  # remove a bogus error message on exit
  patch -p0 <$srcdir/nestopia_bogus_error_on_save_settings.patch
  make PREFIX=/usr -j1
}

package() {
  cd ${srcdir}/rdanbrook-nestopia-*
  mkdir -p $pkgdir/usr/{bin,share/nestopia}
  make install PREFIX=$pkgdir/usr
}
