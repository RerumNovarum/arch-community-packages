# $Id$
# Maintainer: Sergej Pupykin <pupykin.s+arch@gmail.com>
# Maintainer: dibblethewrecker dibblethewrecker.at.jiwe.dot.org

pkgname=gpsman
pkgver=6.4.2
pkgrel=1
pkgdesc="GPS Manager is a graphical GPS data manager for preparing, inspectiing and editing GPS data"
arch=('any')
url="http://gpsman.sourceforge.net/"
license=('GPL')
depends=('tcl' 'tk')
optdepends=('gpsmanshp: shapefile support')
install=gpsman.install
source=(http://downloads.sourceforge.net/project/gpsman/distrib/gpsman-$pkgver.tgz
	'gpsman.desktop')
md5sums=('51ddb0f8aef65520bb850be9a552ac99'
         '0341f110f61e57b316fad7bee483665b')

build() {
  cd ${srcdir}/${pkgname}-${pkgver}
  mkdir -p ${pkgdir}/usr/{bin,share/${pkgname}}

  # set path to program files
  sed -i "s|set SRCDIR gmsrc|set SRCDIR /usr/share/gpsman|g" ./gpsman.tcl
  install -m755 gpsman.tcl ${pkgdir}/usr/bin/gpsman.tcl

  # install a gpsman launcher
  install -m755 util/gpsman.sh ${pkgdir}/usr/bin/gpsman

  #install program files
  cp -r gmsrc/* ${pkgdir}/usr/share/gpsman/
  chmod 755 ${pkgdir}/usr/share/gpsman/*.tcl
  chmod -R 755 ${pkgdir}/usr/share/gpsman/gmicons

  # install some freedesktop.org compatibility
  install -D -m644 ${srcdir}/${pkgname}.desktop \
      ${pkgdir}/usr/share/applications/${pkgname}.desktop
}
