# $Id$
# Contributor: Douglas Soares de Andrade <dsa@aur.archlinux.org>
# Contributor: Andrew Conkling <andrewski@fr.st>
# Maintainer: Daniel J Griffiths <ghost1227@archlinux.us>

pkgname=scribes
pkgver=20100719
pkgrel=2
pkgdesc='A simple PyGTK+ text editor'
arch=('i686' 'x86_64')
url='http://scribes.sourceforge.net'
license=('GPL')
depends=('gnome-python-extras' 'gnome-python-desktop' 'gnome-common' 'dbus-python' 'pygtksourceview2' 'gnome-doc-utils' 'xdg-utils' 'gtkspell' 'yelp')
makedepends=('bzr' 'intltool')

_bzrbranch='lp:scribes'

build() {
	msg 'Connecting to the server....'

	bzr branch ${_bzrbranch}

	msg 'BZR checkout done or server timeout'
	msg 'Starting make...'

	cd ${pkgname}
	sed -i 's/python depcheck.py/python2 depcheck.py/' configure.ac
	./autogen.sh
	sed -i 's/python -OO compile.py/python2 -OO compile.py/' Makefile
	make
}

package() {
	cd ${pkgname}

	make DESTDIR="${pkgdir}" install
	sed -i 's|/usr/bin/python|/usr/bin/python2|' "${pkgdir}/usr/bin/scribes"
	sed -i 's/"python"/"python2"/' "$pkgdir"/usr/lib/python2.7/site-packages/SCRIBES/SaveProcessInitializer/Initializer.py
	sed -i 's|/usr/bin/env python|/usr/bin/env python2|' "$pkgdir"/usr/lib/python2.7/site-packages/SCRIBES/SaveSystem/ExternalProcess/ScribesSaveProcess.py
}
