# $Id: PKGBUILD 72006 2012-06-05 14:34:01Z svenstaro $
# Maintainer: Sven-Hendrik Haase <sh@lutzhaase.com>
# Contributor: Chris Brannon <cmbrannon79@gmail.com>
# Contributor: Andrea Scarpino <andrea@archlinux.org>
# Contributor: Anders Bergh <anders1@gmail.com>
# Contributor: Alexander Fehr <pizzapunk gmail com>

pkgname=('lib32-libphobos')
_pkgname=dmd
pkgver=2.063.1
pkgrel=1
pkgdesc="The phobos D standard library for DMD (32-bit)"
arch=('x86_64')
url="http://www.digitalmars.com/d/2.0/"
#source=(http://ftp.digitalmars.com/$_pkgname.$pkgver.zip)
source=("git+http://github.com/D-Programming-Language/phobos.git#tag=v$pkgver"
        "git+http://github.com/D-Programming-Language/druntime.git#tag=v$pkgver")
makedepends=('dmd' 'git')
depends=('lib32-curl')
license=('custom')
md5sums=('SKIP'
         'SKIP')

build() {
    cd $srcdir/druntime
    make -f posix.mak MODEL=32

    cd $srcdir/phobos
    make -f posix.mak MODEL=32
}

package() {
  #install -Dm644 $srcdir/phobos/src/druntime/lib/libdruntime-linux32.a $pkgdir/usr/lib32/libdruntime.a
  install -Dm644 $srcdir/phobos/generated/linux/release/32/libphobos2.a $pkgdir/usr/lib32/libphobos2.a
  install -Dm644 $srcdir/phobos/generated/linux/release/32/libphobos2.so $pkgdir/usr/lib32/libphobos2.so

  install -Dm644 $srcdir/druntime/LICENSE $pkgdir/usr/share/licenses/$pkgname/LICENSE
}
