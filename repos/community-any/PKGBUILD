# $Id$
# Maintainer: Sven-Hendrik Haase <sh@lutzhaase.com>
pkgname=speed-dreams-data
_pkgname=speed-dreams
pkgver=2.2.0
_pkgver=2.2.0-r6381
pkgrel=1
pkgdesc="A racing simulator with rich graphics and physics (data files)"
arch=('any')
url="http://speed-dreams.sourceforge.net/"
license=('GPL2')
depends=()
makedepends=('sdl2' 'freealut' 'freeglut' 'libpng' 'libxmu' 'libxrandr' 'plib' 'libjpeg' 'zlib' 'enet' 'cmake' 'tar' 'libvorbis' 'glu' 'openscenegraph')
noextract=("${_pkgname}-src-base-${_pkgver}.tar.xz"
           "${_pkgname}-src-unmaintained-${_pkgver}.tar.xz"
           "${_pkgname}-src-wip-cars-and-tracks-${_pkgver}.tar.xz"
           "${_pkgname}-src-hq-cars-and-tracks-${_pkgver}.tar.xz"
           "${_pkgname}-src-more-hq-cars-and-tracks-${_pkgver}.tar.xz")
source=("http://downloads.sourceforge.net/sourceforge/${_pkgname}/${_pkgname}-src-base-${_pkgver}.tar.xz"
        "http://downloads.sourceforge.net/sourceforge/${_pkgname}/${_pkgname}-src-unmaintained-${_pkgver}.tar.xz"
        "http://downloads.sourceforge.net/sourceforge/${_pkgname}/${_pkgname}-src-wip-cars-and-tracks-${_pkgver}.tar.xz"
        "http://downloads.sourceforge.net/sourceforge/${_pkgname}/${_pkgname}-src-hq-cars-and-tracks-${_pkgver}.tar.xz"
        "http://downloads.sourceforge.net/sourceforge/${_pkgname}/${_pkgname}-src-more-hq-cars-and-tracks-${_pkgver}.tar.xz")
md5sums=('fd93042ff7c68d85e121165712c5fe43'
         'c80ec7c64d3954c1eca2f8d94d9961af'
         'b13f3d8f209d0b9f64256a14393a2812'
         'ecd7dc65a679502e376b4800a5b0fe41'
         '85214b13f1ac0aced717d456bea2605c')

prepare() {
  # extract these manually as bsdtar can't handle these
  tar xf "${_pkgname}-src-base-${_pkgver}.tar.xz"
  tar xf "${_pkgname}-src-unmaintained-${_pkgver}.tar.xz"
  tar xf "${_pkgname}-src-wip-cars-and-tracks-${_pkgver}.tar.xz"
  tar xf "${_pkgname}-src-hq-cars-and-tracks-${_pkgver}.tar.xz"
  tar xf "${_pkgname}-src-more-hq-cars-and-tracks-${_pkgver}.tar.xz"
}

build() {
  cmake . \
    -DCMAKE_BUILD_TYPE=Release \
    -DCMAKE_INSTALL_PREFIX=/usr \
    -DSD_BINDIR=/usr/bin \
    -DSD_DATADIR=/usr/share/speed-dreams-2 \
    -DSD_LIBDIR=/usr/lib/speed-dreams-2 \
    -DOPTION_OFFICIAL_ONLY=ON
}

package() {
  make DESTDIR="${pkgdir}/" install

  rm -r "${pkgdir}/usr/bin"
  rm -r "${pkgdir}/usr/lib"
  rm -r "${pkgdir}/usr/include"
}

# vim:set ts=2 sw=2 et:
