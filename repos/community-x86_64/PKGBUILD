# $Id$
# Maintainer: Sergej Pupykin <pupykin.s+arch@gmail.com>
# Contributor: Tiago Pierezan Camargo <tcamargo@gmail.com>
# Contributor: robb_force <robb_force@holybuffalo.net>

pkgname=nestopia
pkgver=1.42
pkgrel=1
pkgdesc='An NES emulator featuring cycle exact emulation, a ridiculous number of mappers, and lots of custom sound chips.'
url='http://0ldsk00l.ca/nestopia.html'
license=('GPL')
arch=('i686' 'x86_64')
depends=('sdl' 'alsa-lib' 'gtk3' 'mesa')
makedepends=('unzip')
source=("$pkgname-$pkgver.tar.gz::https://github.com/rdanbrook/nestopia/tarball/$pkgver")
md5sums=('ce7ffba59f19c764f08546e015777172')

build() {
  cd ${srcdir}/rdanbrook-nestopia-*
  sed -i 's|/usr/share/pixmaps|$(PREFIX)/share/pixmaps|g' Makefile
  sed -i 's|xdg-desktop-menu install.*|install -Dm0644 $(DATADIR)/nestopia.desktop $(PREFIX)/share/applications/nestopia.desktop|' Makefile
  make PREFIX=/usr -j1
}

package() {
  cd ${srcdir}/rdanbrook-nestopia-*
  mkdir -p $pkgdir/usr/{bin,share/nestopia}
  make install PREFIX=$pkgdir/usr
}
