# $Id$
# Contributor: Pierre Schmitz <pierre@archlinux.de>
# Contributor: Clement Siuchung Cheung <clement.cheung@umich.edu>
# Maintainer: Mikko Seppälä <t-r-a-y@mbnet.fi>
_pkgsourcename=glibc
pkgname=lib32-$_pkgsourcename
pkgver=2.10.1
pkgrel=2
arch=(x86_64)
groups=('lib32')
pkgdesc="GNU C Library (32 Bit)"
url="http://www.gnu.org/software/libc"
license=('GPL' 'LGPL')
install=$pkgname.install
source=(ftp://ftp.archlinux.org/core/os/i686/$_pkgsourcename-$pkgver-$pkgrel-i686.pkg.tar.gz)
md5sums=('b8f6a42d70cfcbea0a171f8225ad55fe')

build() {
	cd $startdir/src

	mkdir -p $startdir/pkg/opt/lib32/lib
	mkdir -p $startdir/pkg/opt/lib32/usr/lib/gconv

	cp -dp lib/*.so* $startdir/pkg/opt/lib32/lib
	cp -dp usr/lib/*.so* $startdir/pkg/opt/lib32/usr/lib
	cp -dp usr/lib/gconv/* $startdir/pkg/opt/lib32/usr/lib/gconv

	cat /usr/bin/ldd | sed 's/\/lib\/ld-linux-x86-64.so.2/\/lib\/ld-linux-x86-32.so.2/' > $startdir/src/ldd32
	install -D -m755 $startdir/src/ldd32 $startdir/pkg/usr/bin/ldd32

	mkdir -p $startdir/pkg/lib
	ln -s /opt/lib32/lib/ld-linux.so.2 $startdir/pkg/lib/ld-linux-x86-32.so.2
}
